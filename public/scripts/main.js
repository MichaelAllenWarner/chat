!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const r={publicid:void 0,privateid:void 0},o=location.origin.replace(/^http/,"ws"),s=new WebSocket(o);var i,c=e=>{const t=e.errorType,n=e.errorData;switch(t){case"badObject":alert("Error: Stop trying to hack me!");break;case"takenUsername":{const e=document.querySelector("#username-label"),t=Array.from(document.querySelectorAll("#usernames-list li")).find(e=>e.getAttribute("data-publicid")===n.publicidOfTakenUsername),r=e=>(function(){this.classList.remove(e)});e.addEventListener("animationend",r("bad-username"),{once:!0}),t.addEventListener("animationend",r("taken-username"),{once:!0}),e.classList.add("bad-username"),t.classList.add("taken-username");break}}};((e,t)=>{const n=document.querySelector("#message-input"),r=document.querySelector("#username-input");function o(o){if("Enter"===o.key){const o=document.querySelector("#own-user").textContent,s=o.substring(0,o.length-6),i=r.value.trim(),c=i!==s&&!(!i&&"An anonymous user"===s),a=n.value,u=!!a.trimStart();(c||u)&&(t.send(JSON.stringify({type:"text",text:a,time:Date.now(),privateid:e.privateid,publicid:e.publicid,username:i})),u&&(n.value=""))}}n.addEventListener("keydown",o),r.addEventListener("keydown",o)})(r,s),i=r,s.onmessage=(e=>{const t=JSON.parse(e.data);switch(t.type){case"ids":Object.assign(i,t.ids);break;case"error":c(t);break;case"users":((e,t)=>{const n=document.querySelector("#usernames-list");for(;n.firstChild;)n.removeChild(n.firstChild);const r=document.createElement("li");r.id="own-user",r.setAttribute("data-publicid",t),n.appendChild(r);for(const[o,s]of Object.entries(e))if(o===t)r.textContent=s?`${s} (You)`:"An anonymous user (You)";else{const e=document.createElement("li");e.textContent=s||"An anonymous user",e.setAttribute("data-publicid",o),n.appendChild(e)}})(t.usernames,i.publicid);break;case"text":((e,t)=>{const n=document.createElement("p");n.setAttribute("data-time",new Date(e.time));const r=e.publicid===t?"own-message":"other-message";n.classList.add(r);const o=document.createElement("span"),s=e.username||"An anonymous user";o.textContent=`${s}: `,o.classList.add("username-prefix"),n.appendChild(o);const i=document.createTextNode(e.text);n.appendChild(i);const c=document.querySelector("#messages"),a=c.scrollHeight-c.scrollTop<=c.clientHeight+5;c.appendChild(n),a&&(c.scrollTop=c.scrollHeight-c.clientHeight)})(t,i.publicid)}}),(()=>{function e(){const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}e(),window.addEventListener("resize",()=>{e(),function(){const e=document.activeElement;e.classList.contains("content-input")&&e.parentNode.parentNode.scrollIntoView(!1)}(),function(){const e=document.querySelector("#messages");e.scrollTop=e.scrollHeight-e.clientHeight}()})})(),(()=>{const e=document.querySelector("#menu-logo"),t=document.querySelector("#menu");function n(n){!t.classList.contains("menu-in")||t.contains(n.target)||e.contains(n.target)||e.click()}e.addEventListener("click",()=>{t.classList.toggle("menu-in"),t.classList.toggle("menu-out")}),document.addEventListener("touchstart",n),document.addEventListener("click",n)})(),document.querySelector("#dark-mode-toggler").addEventListener("click",()=>{document.querySelector("html").classList.toggle("dark-mode")})}]);