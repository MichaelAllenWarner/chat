!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const o={publicid:void 0,privateid:void 0},r=location.origin.replace(/^http/,"ws"),i=new WebSocket(r);!function(e,t){const n=document.querySelector("#message-input"),o=document.querySelector("#username-input");function r(r){if("Enter"===r.key){const r=document.querySelector("#own-user").textContent,i=r.substring(0,r.length-6),s=o.value.trim(),c=s!==i&&!(!s&&"An anonymous user"===i),a=n.value,u=!!a.trimStart();(c||u)&&(t.send(JSON.stringify({type:"text",text:a,time:Date.now(),privateid:e.privateid,publicid:e.publicid,username:s})),u&&(n.value=""))}}n.addEventListener("keydown",r),o.addEventListener("keydown",r)}(o,i),function(e,t){t.onmessage=(t=>{const n=JSON.parse(t.data);switch(n.type){case"ids":Object.assign(e,n.ids);break;case"error":!function(e,t){switch(e){case"badObject":alert("Error: Stop trying to hack me!");break;case"takenUsername":{const e=document.querySelector("#username-label"),n=Array.from(document.querySelectorAll("#usernames-list li")),o=n.find(e=>e.getAttribute("data-publicid")===t.publicidOfTakenUsername),r=e=>(function(){this.classList.remove(e)});e.addEventListener("animationend",r("bad-username"),{once:!0}),o.addEventListener("animationend",r("taken-username"),{once:!0}),e.classList.add("bad-username"),o.classList.add("taken-username");break}}}(n.errorType,n.errorData);break;case"users":!function(t){const n=document.querySelector("#usernames-list");for(;n.firstChild;)n.removeChild(n.firstChild);const o=document.createElement("li");o.id="own-user",o.setAttribute("data-publicid",e.publicid),n.appendChild(o);for(const[r,i]of Object.entries(t))if(r===e.publicid)o.textContent=i?`${i} (You)`:"An anonymous user (You)";else{const e=document.createElement("li");e.textContent=i||"An anonymous user",e.setAttribute("data-publicid",r),n.appendChild(e)}}(n.usernames);break;case"text":!function(t,n,o,r){const i=document.createElement("p");i.setAttribute("data-time",new Date(r));const s=n===e.publicid?"own-message":"other-message";i.classList.add(s);const c=document.createElement("span"),a=o||"An anonymous user";c.textContent=`${a}: `,c.classList.add("username-prefix"),i.appendChild(c);const u=document.createTextNode(t);i.appendChild(u);const d=document.querySelector("#messages"),l=d.scrollHeight,m=d.scrollTop,p=d.clientHeight,f=l-m<=p+5;d.appendChild(i),f&&(d.scrollTop=d.scrollHeight-d.clientHeight)}(n.text,n.publicid,n.username,n.time)}})}(o,i),function(){function e(){const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}e(),window.addEventListener("resize",()=>{e(),function(){const e=document.activeElement;e.classList.contains("content-input")&&e.parentNode.parentNode.scrollIntoView(!1)}(),function(){const e=document.querySelector("#messages");e.scrollTop=e.scrollHeight-e.clientHeight}()})}(),function(){const e=document.querySelector("#menu-logo"),t=document.querySelector("#menu");function n(n){!t.classList.contains("menu-in")||t.contains(n.target)||e.contains(n.target)||e.click()}e.addEventListener("click",()=>{t.classList.toggle("menu-in"),t.classList.toggle("menu-out")}),document.addEventListener("touchstart",n),document.addEventListener("click",n)}(),document.querySelector("#dark-mode-toggler").addEventListener("click",()=>{document.querySelector("html").classList.toggle("dark-mode")})}]);